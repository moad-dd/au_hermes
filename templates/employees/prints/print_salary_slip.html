{% extends 'base.html' %}

{% block title %}Salary Slip - {{ fonctionnaire.nom }}{% endblock %}

{% block content %}
<style>
  @media print {
    .no-print { display: none !important; }
    body { background: white !important; }
  }
</style>

<div class="container mt-4">
  <div class="card border-0 shadow" style="max-width: 900px; margin: auto;">
    <div class="card-body p-5">
      <!-- Header -->
      <div class="text-center mb-4 pb-3 border-bottom">
        <h2 class="text-primary fw-bold">AU HERMES</h2>
        <p class="text-muted">Human Resources Department</p>
      </div>

      <!-- Title -->
      <h3 class="text-center fw-bold mb-4">SALARY SLIP</h3>

      <!-- Employee Info -->
      <div class="row mb-4">
        <div class="col-md-6">
          <p><strong>Name:</strong> {{ fonctionnaire.nom }} {{ fonctionnaire.prenom }}</p>
          <p><strong>Grade:</strong> {{ fonctionnaire.grade }}</p>
        </div>
        <div class="col-md-6 text-end">
          {% if paie %}
          <p><strong>Month:</strong> {{ paie.mois }}</p>
          <p><strong>Year:</strong> {{ paie.annee }}</p>
          {% endif %}
        </div>
      </div>

      <!-- Salary Details -->
      {% if paie %}
      <table class="table table-bordered">
        <thead class="table-light">
          <tr>
            <th>Description</th>
            <th class="text-end">Amount (DA)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Base Salary</td>
            <td class="text-end">{{ paie.salaire_base|floatformat:2 }}</td>
          </tr>
          <tr>
            <td>Allowances</td>
            <td class="text-end text-success">+ {{ paie.indemnites|floatformat:2 }}</td>
          </tr>
          <tr>
            <td>Deductions</td>
            <td class="text-end text-danger">- {{ paie.retenues|floatformat:2 }}</td>
          </tr>
          <tr class="table-primary fw-bold">
            <td>Net Payable</td>
            <td class="text-end">{{ paie.net_a_payer|floatformat:2 }} DA</td>
          </tr>
        </tbody>
      </table>

      <!-- Footer -->
      <div class="row mt-5">
        <div class="col-md-6">
          <p><small>Generated on: {{ paie.date_ajout|date:"F d, Y" }}</small></p>
        </div>
        <div class="col-md-6 text-end">
          <p class="mb-5">_______________________</p>
          <p><strong>HR Manager Signature</strong></p>
        </div>
      </div>
      {% else %}
      <div class="alert alert-warning">
        No salary record found for this employee.
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Print Button -->
  <div class="text-center mt-4 no-print">
    <button onclick="window.print()" class="btn btn-primary px-5">
      <i class="bi bi-printer"></i> Print Slip
    </button>
    <a href="{% url 'civil_servant_detail' fonctionnaire.id %}" class="btn btn-secondary px-5">
      <i class="bi bi-arrow-left"></i> Back
    </a>
  </div>
</div>
{% endblock %}